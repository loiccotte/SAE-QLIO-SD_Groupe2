{% extends "base.html" %}

{% block title %}Dashboard - T'ELEFAN MES 4.0{% endblock %}

{% block breadcrumbs %}
<div class="border-t border-zinc-100 bg-zinc-50/50">
    <div class="max-w-[1400px] mx-auto px-4 py-2">
        <span class="text-sm font-medium text-zinc-900">Tableau de bord global</span>
    </div>
</div>
{% endblock %}

{% block content %}
<!-- Ligne 1 : 3 cards (Performance, Qualite, Delai) -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">

    <!-- PERFORMANCE (Rouge) -->
    <a href="{{ url_for('main.performance') }}"
       class="kpi-card block bg-white rounded-2xl border border-zinc-200/50
              shadow-[0_4px_12px_-4px_rgba(0,0,0,0.04)] overflow-hidden">
        <div class="h-1.5 kpi-bar-perf"></div>
        <div class="p-6">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-xs font-semibold text-zinc-400 uppercase tracking-wider">
                    Performance
                </h2>
                {% if kpis.oee.status != 'normal' %}
                <span class="alert-blink">
                    <svg class="w-5 h-5 text-perf" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                    </svg>
                </span>
                {% endif %}
            </div>
            <p class="text-xs text-zinc-500 mb-1">KPI: OEE</p>
            <div class="flex items-baseline gap-1">
                <span class="text-4xl font-bold tracking-tight font-mono text-zinc-900">
                    {{ kpis.oee.value }}%
                </span>
                {% if kpis.oee.status == 'warning' %}
                <span class="text-xs font-medium text-amber-500 ml-1">Attention</span>
                {% elif kpis.oee.status == 'critical' %}
                <span class="text-xs font-medium text-perf ml-1">Critique</span>
                {% endif %}
            </div>
        </div>
    </a>

    <!-- QUALITE (Bleu) -->
    <a href="{{ url_for('main.qualite') }}"
       class="kpi-card block bg-white rounded-2xl border border-zinc-200/50
              shadow-[0_4px_12px_-4px_rgba(0,0,0,0.04)] overflow-hidden">
        <div class="h-1.5 kpi-bar-qualite"></div>
        <div class="p-6">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-xs font-semibold text-zinc-400 uppercase tracking-wider">
                    Qualite
                </h2>
                {% if kpis.non_conformity.status != 'normal' %}
                <span class="alert-blink">
                    <svg class="w-5 h-5 text-qualite" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                    </svg>
                </span>
                {% endif %}
            </div>
            <p class="text-xs text-zinc-500 mb-1">KPI: Non-conformite</p>
            <div class="flex items-baseline gap-1">
                <span class="text-4xl font-bold tracking-tight font-mono text-zinc-900">
                    {{ kpis.non_conformity.value }}%
                </span>
                {% if kpis.non_conformity.status == 'normal' %}
                <svg class="w-5 h-5 text-green-500 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                </svg>
                {% endif %}
            </div>
        </div>
    </a>

    <!-- DELAI (Rose) -->
    <a href="{{ url_for('main.delai') }}"
       class="kpi-card block bg-white rounded-2xl border border-zinc-200/50
              shadow-[0_4px_12px_-4px_rgba(0,0,0,0.04)] overflow-hidden">
        <div class="h-1.5 kpi-bar-delai"></div>
        <div class="p-6">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-xs font-semibold text-zinc-400 uppercase tracking-wider">
                    Delai
                </h2>
                {% if kpis.lead_time.status != 'normal' %}
                <span class="alert-blink">
                    <svg class="w-5 h-5 text-pink-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                    </svg>
                </span>
                {% endif %}
            </div>
            <p class="text-xs text-zinc-500 mb-1">KPI: Lead Time</p>
            <span class="text-4xl font-bold tracking-tight font-mono text-zinc-900">
                {{ kpis.lead_time.value }}h
            </span>
        </div>
    </a>
</div>

<!-- Ligne 2 : 2 cards (Energie, Stock) -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- ENERGIE (Vert) -->
    <a href="{{ url_for('main.energie') }}"
       class="kpi-card block bg-white rounded-2xl border border-zinc-200/50
              shadow-[0_4px_12px_-4px_rgba(0,0,0,0.04)] overflow-hidden">
        <div class="h-1.5 kpi-bar-energie"></div>
        <div class="p-6">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-xs font-semibold text-zinc-400 uppercase tracking-wider">
                    Energie
                </h2>
            </div>
            <p class="text-xs text-zinc-500 mb-1">KPI: Consommation</p>
            <span class="text-4xl font-bold tracking-tight font-mono text-zinc-900">
                {{ kpis.energy.value }} {{ kpis.energy.unit }}
            </span>
        </div>
    </a>

    <!-- STOCK (Gris) -->
    <a href="{{ url_for('main.stock') }}"
       class="kpi-card block bg-white rounded-2xl border border-zinc-200/50
              shadow-[0_4px_12px_-4px_rgba(0,0,0,0.04)] overflow-hidden">
        <div class="h-1.5 kpi-bar-stock"></div>
        <div class="p-6">
            <div class="flex items-center justify-between mb-3">
                <h2 class="text-xs font-semibold text-zinc-400 uppercase tracking-wider">
                    Stock
                </h2>
                {% if kpis.buffer.status != 'normal' %}
                <span class="alert-blink">
                    <svg class="w-5 h-5 text-stock" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" />
                    </svg>
                </span>
                {% endif %}
            </div>
            <p class="text-xs text-zinc-500 mb-1">KPI: Occupation</p>
            <span class="text-4xl font-bold tracking-tight font-mono text-zinc-900">
                {{ kpis.buffer.value }}%
            </span>
        </div>
    </a>
</div>
{% endblock %}
